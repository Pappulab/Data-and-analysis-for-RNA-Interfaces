function [pd_perp, pd_par, ci99_perp, ci99_par,figure1]=diffusion1Dgauss(jump_perp_list,jump_par_list,binsNum,binsLimit)
sz = size(jump_perp_list,1);
pd_perp = fitdist(jump_perp_list,'Normal');
pd_par = fitdist(jump_par_list,'Normal');
ci99_perp = paramci(pd_perp,'Alpha',.01);
ci99_par = paramci(pd_par,'Alpha',.01);
gauss_perp = normrnd(pd_perp.mu,pd_perp.sigma,[sz,1]);
gauss_par = normrnd(pd_par.mu,pd_par.sigma,[sz,1]);

figure1 = figure('Position',[100,100,1400,350]);  subplot(1,3,[1,2]), 
h1 = histfit_YQdefined(jump_perp_list,"normal",binsLimit,binsNum);  hold on;
h2 = histfit_YQdefined(jump_par_list,"normal",binsLimit,binsNum); 
set(h1(1),'facecolor',"#D95319",'faceAlpha',0.7,'DisplayName','perpendicular'); set(h1(2),'color',"#D95319")
set(h2(1),'facecolor',"#4DBEEE",'faceAlpha',0.6,'DisplayName','parallel'); set(h2(2),'color', "#4DBEEE")
legend([h1(1),h2(1)]);
xlabel('Displacement per 10ms'), ylabel('counts');   
title('Displacement per frame of molecules'); xlim([-300,300]);

% subplot(1,3,3);  % qq-plot
% scatter(sort(gauss_perp), sort(jump_perp_list),[0.850980392156863 0.325490196078431 0.0980392156862745],'filled');
% scatter(sort(gauss_par), sort(jump_par_list),[0.301960784313725 0.745098039215686 0.933333333333333],'filled');
subplot(2,3,3); qqplot(jump_perp_list,pd_perp); ylabel("Perp Diffusion Quantiles"); title('QQ Plot of Perp Diffusion v.s Standard Normal')
subplot(2,3,6); qqplot(jump_par_list,pd_par); ylabel("Par Diffusion Quantiles"); title('QQ Plot of Par Diffusion v.s Standard Normal')


annotation(figure1,'textbox',...
    [0.43959410430839 0.503265306122448 0.143160997732426 0.22222222222],...
    'Color',[1 1 1],...
    'String',{'Fit Mean: (99% confidence)',[num2str(pd_perp.mu),'   [',num2str(ci99_perp(1,1)),', ',num2str(ci99_perp(2,1)),']'],...
    'Fit STD:  (99% confidence)',[num2str(pd_perp.sigma),'   [',num2str(ci99_perp(1,2)),', ',num2str(ci99_perp(2,2)),']']},...
    'FitBoxToText','off',...
    'BackgroundColor',[0.850980392156863 0.325490196078431 0.0980392156862745]);

annotation(figure1,'textarrow',[0.423571428571429 0.403775510204082],...
    [0.647755102040816 0.656734693877551],...
    'Color',[0.850980392156863 0.325490196078431 0.0980392156862745],...
    'LineWidth',5,...
    'HeadStyle','plain');


annotation(figure1,'textbox',...
    [0.15437641723356 0.298367346938775 0.141848072562358 0.22222222222],...
     'String',{'Fit Mean: (99% confidence)',[num2str(pd_par.mu),'   [',num2str(ci99_par(1,1)),', ',num2str(ci99_par(2,1)),']'],...
    'Fit STD:  (99% confidence)',[num2str(pd_par.sigma),'   [',num2str(ci99_par(1,2)),', ',num2str(ci99_par(2,2)),']']},...
    'FitBoxToText','off',...
    'BackgroundColor',[0.301960784313725 0.745098039215686 0.933333333333333]);

annotation(figure1,'textarrow',[0.268877551020408 0.28234693877551],...
    [0.28430612244898 0.210204081632653],...
    'Color',[0.301960784313725 0.745098039215686 0.933333333333333],...
    'LineWidth',5,...
    'HeadStyle','plain');